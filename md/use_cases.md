# :wrench: Реальные примеры использования

## Автоматизация процессов

[comment]: (https://xakep.ru/2018/08/24/clojure-flower/)

Язык программирования Clojure используется такими open source проектами, как NASA CMR, Cisco Threat Grid, CircleCI, Jepsen, стартапами и некоторыми крупными компаниями. Некоторые из этих компаний используют Clojure как платформу для базовой автоматизации процессов управления разработкой ПО.

Распределение задач - одна из рутинных процедур, которую легко автоматизировать, если в команде существует матрица компетенций: назначить исполнителя в зависимости от заголовка задачи или ее компонента можно, если уметь программно читать задачу с таск-трекера и обновлять некоторые поля в ней. Аналогичная история с автоматическим назначением по набору критериев ответственного проверяющего в пулл-реквест в системе контроля версий для рецензирования исходного кода.

Зачем такое программное обеспечение может понадобиться тимлиду, в целом понятно, но зачем же оно может понадобиться вам?

Допустим, по счастливому стечению обстоятельств, у вас есть учетные данные некоего пользователя Jira. Очень хочется на память сохранить пару тысяч задач этого пользователя (а заодно и всю его почту), чтобы развлекаться серыми осенними вечерами, почитывая занимательные комментарии. Почему бы не сделать это, написав всего три строчки кода?

Или вы являетесь менеджером проекта по разработке программных продуктов и решили устроить своим программистам полный KPI, замеряя производительность людей в условных пулл-реквестах на задачу. Собирать статистику с двух и более разных систем одновременно тоже можно без технических проблем.

Как вариант, вы желаете перенести все задачи из GitLab и Jira на GitHub (потому что твой проект резко стал опенсорсным), а заодно настроить автоматическую пересылку сообщений из почты в Slack. И даже это делается не очень сложно!

Здесь ещё напрашивается два очевидных вопроса:

1. Почему не Python? Ведь вы с ним наверняка знакомы уже несколько лет и он имеет все необходимые библиотеки интеграций. Имеет, конечно, но не все работает так гладко, особенно если ваше ПО основано на JVM. А в некоторых случаях еще и не хватает многопоточности.

2. Почему вообще Lisp? Потому что, насколько мне известно, лучший способ создать свой DSL (Domain-Specific Language), не изобретая новый синтаксис, - взять Lisp, проверенный временем язык с префиксной нотацией и веселыми скобочками (на самом деле это называется S-выражения), и, используя макросы, обогатить его до домена использования.

Вот почему можно выбрать Clojure как язык программирования и платформу для интеграций с различными системами.



## Server-side rendering

[comment]: (https://habr.com/ru/post/527310/)

### Проблема

Главной проблемой Single Page приложений является то, что сервер отдает клиенту пустую HTML страницу. Её формирование происходит только после того как весь JS будет скачан (это весь ваш код, библиотеки, фреймворк). Это в большинстве случаев более 2-х мегабайт размера + задержки на обработку кода.

Даже если Google-бот умеет выполнять JS, он получает контент только спустя некоторое время, критичное для ранжирования сайта. Google-бот попросту видит пустую страницу несколько секунд! Это плохо!

### Решение

Существует несколько путей как решить проблему пустой странички при загрузке, рассмотрим несколько из них:

1. **Static Site Generation (SSG)**. Сделать пререндер сайта перед тем как его загрузить на сервер. Очень простое и эффективное решение. Отлично подходит для простых веб страничек, без взаимодействия с backend API.

2. **Server-Side Rendering (SSR)**. Рендерить контент в рантайме на сервере. При таком подходе мы сможем делать запросы backend API и отдавать HTML вместе с необходимым содержимым.

Server-Side Rendering (SSR)

Рассмотрим подробнее, как работает SSR:

- У нас должен быть сервер, который выполняет наше приложение точно так же, как делал бы это пользователь в браузере. Делая запросы на необходимые ресурсы, отображая весь необходимый HTML, наполняя состояние.
- Сервер отдает клиенту наполненный HTML, наполненное состояние, а также отдает все необходимые JS, CSS и прочие ресурсы.
- Клиент, получая HTML и ресурсы, синхронизирует состояние и работает с приложением как с обычным Single Page Application. При этом важным моментом является то, что состояние должно синхронизироваться.

А как гененировать HTML, CSS и JS на стороне сервера? Вы уверены, что какой-нибудь JS-фреймворк будет легче интегрировать в любой проект? А что с эффективностью?

Эти вопросы могут навести на мысль о том, что в некоторых случаях стоит рассмотреть Clojure для решения поставленной задачи. Тем более даже бибилиотеки для этого завезли:

- [Генерация HTML](https://github.com/weavejester/hiccup)
- [Генерация CSS](https://github.com/noprompt/garden)
- Про генерацию JS говорилось [здесь](motivation.md)



## Другие примеры использования Clojure:

Пользовательские библиотеки могут много сказать о сферах применения языка. Вот что можно найти с помощью поверхностного поиска по GitHub:

- [Построение SQL-запросов](https://github.com/seancorfield/honeysql)
- [Мониторинг распределенных систем](https://github.com/riemann/riemann)
- [Генерация документации](https://github.com/weavejester/codox)
- [Интерпретатор Clojure для написания скриптов а-ля bash.](https://github.com/babashka/babashka)
- [Обработка изображений](https://github.com/Clojure2D/clojure2d)
- [Markdown parser](https://github.com/yogthos/markdown-clj)
- [Взаимодействие с библиотекой OpenNLP (Open Natural Language Processing)](https://github.com/dakrone/clojure-opennlp)

Интересные pet-проекты:
- [News Web Application](https://github.com/ertugrulcetin/ClojureNews)
- [Codecademy for Clojure](https://github.com/clojurecademy/clojurecademy)

Больше можно найти, например, [здесь](https://github.com/search?l=Clojure&p=1&q=clojure&type=Repositories).



## Итог

Одни и те же задачи можно решать разными способами. Какие-то из них популярны, а какие-то нет. Например, увидев генерацию HTML и CSS на Clojure, JavaScript-разработчики, возможно, почувствовали аналогию с тем, как если бы гвоздь забивали гантелей. Здесь важно помнить, что функциональная парадигма (и Clojure в частности) лишь предоставляет новый подход к решению уже давно знакомых задач.  Гантеля тоже может забить гвоздь, причём даже тогда, когда нужного молотка нет под рукой...

[Предыдущий шаг](samples.md)

[К оглавлению](../README.md)
